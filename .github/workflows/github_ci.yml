# name of our workflow
name: Django CI/CD Workflow

on:
  push:
    branches:
      - master

jobs:
  package-job: # package job for building and publishing docker images
    runs-on: self-hosted
    if: ${{ github.event_name == 'push' }} # will be fired if the trigger event is a push event.
    steps:
      - name: Checkout Code # checking out code.
        uses: actions/checkout@v2
      
      - name: Build Image
        run: docker-compose build

      - name: Push Image
        env:
          VERSION: "10.0.0"
          COMPILED_IMAGE: gcr.io/nib-backend-nonprod/python:$VERSION
        run: docker push $COMPILED_IMAGE


        
    