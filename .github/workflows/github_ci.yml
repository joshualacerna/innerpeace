# name of our workflow
name: Django CI/CD Workflow

on:
  push:
    branches:
      - master


  package-job: # package job for building and publishing docker images
    runs-on: self-hosted
    # needs: [health-check-job] # will be fired if and only if health-check-job is passed.
    if: ${{ github.event_name == 'push' }} # will be fired if the trigger event is a push event.
    steps:
      - name: Checkout Code # checking out code.
        uses: actions/checkout@v2

      # - name: Build & Publish Image # we are using a public GitHub Action to build and publish docker image to our GCR registry.
      #   run: docker-compose build
      
      - name: Build & Publish Image
        env:
          VERSION: "10.0.0"
          COMPILED_IMAGE: gcr.io/nib-backend-nonprod/python:$VERSION
        run: |
        docker-compose build

        
    